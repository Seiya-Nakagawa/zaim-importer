# 要件定義書 (Requirements Definition)

## 1. プロジェクトの目的

楽天Payや楽天カードなどの利用通知メールを自動的に読み取り、家計簿アプリ「Zaim」に支出として自動登録することで、家計簿入力の手間を削減する。

## 2. 対象範囲 (Scope)

- **入力**: Gmailに着信する決済サービスの利用通知メール
- **出力**: Zaimへの支出データ登録

## 3. 機能要件 (Functional Requirements)

### 3.1. メール取得機能

- **Google Apps Script (GAS)** をプラットフォームとして利用する。
- 指定された期間（設定値で指定した日数前〜現在）のメールを対象とする。
- 特定の送信元および件名でフィルタリングを行う。

### 3.2. メール解析・カテゴリ判定機能

- メール本文から以下の情報を抽出できること。
  - 利用日時
  - 利用金額
  - 利用店舗名（または利用サービス名）
- **カテゴリ自動判定機能**:
  - **AI (LLM)** および **事前定義ルール** を活用し、店舗名から適切なZaimカテゴリを判定できること。
  - 未知の店舗名に対しても、AIによる推論でカテゴリを提案できること。

### 3.3. Zaim連携機能

- Zaim APIを使用して、抽出したデータを支出として登録できること。
- **OAuth 1.0a 認証**:
  - 安全な認証フローを用いてアクセストークンを取得・管理できること。
- **登録データの識別**:
  - システム経由で登録されたデータであることを識別可能にし、重複登録の防止やデータ管理に役立てること。

### 3.4. 運用・保守機能

- **データ削除機能**: テスト時や誤登録時に、本システムが登録したデータを一括削除する機能を提供する。

## 4. 非機能要件 (Non-Functional Requirements)

- **セキュリティ**:
  - 認証情報やAPIキーなどの機密情報は、コード内に記述せず、安全な設定領域で管理すること。
- **パフォーマンス**:
  - 外部APIのレート制限を遵守し、安定して動作すること。
